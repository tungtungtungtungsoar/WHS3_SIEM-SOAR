<!-- syscheck_webshell.xml -->
<group name="linux, webshell, windows,">
    <!-- This rule detects file creation. -->
    <rule id="100500" level="12">
        <if_sid>554</if_sid>
        <field name="file" type="pcre2">
            (?i).php$|.phtml$|.php3$|.php4$|.php5$|.phps$|.phar$|.asp$|.aspx$|.jsp$|.cshtml$|.vbhtml$</field>
        <description>[File creation]: Possible web shell scripting file ($(file)) created</description>
        <mitre>
            <id>T1105</id>
            <id>T1505</id>
        </mitre>
    </rule>

    <!-- This rule detects file modification. -->
    <rule id="100501" level="12">
        <if_sid>550</if_sid>
        <field name="file" type="pcre2">
            (?i).php$|.phtml$|.php3$|.php4$|.php5$|.phps$|.phar$|.asp$|.aspx$|.jsp$|.cshtml$|.vbhtml$</field>
        <description>[File modification]: Possible web shell content added in $(file)</description>
        <mitre>
            <id>T1105</id>
            <id>T1505</id>
        </mitre>
    </rule>
</group> 